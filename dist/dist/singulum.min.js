/*!
 * Library: singulum
 * Description: State management sanity with minimal effort
 * Author: planttheidea
 * Version: 1.0.1
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("singulum",[],e):"object"==typeof exports?exports.singulum=e():t.singulum=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=n(2),i=(r=o)&&r.__esModule?r:{default:r};e.default=new i.default,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Singulum=e.SingulumSnapshot=e.SingulumStore=e.SingulumActions=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(3);function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=Object.freeze,c=(0,o.isProduction)(),a=0,f=function(t){t.$$watchers.forEach(function(e){e(t.store)})},l=e.SingulumActions=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,t);var n=c?{}:this;return(0,o.forEachObject)(e,function(t,r){(0,o.setImmutable)(n,r,e[r])}),c||s(n),n}return r(t,[{key:"log",value:function(){console&&console.log((0,o.getMutableObject)(this))}}]),t}(),h=e.SingulumStore=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,t);var n=c?{}:this;return(0,o.forEachObject)(e,function(t,e){(0,o.setImmutable)(n,e,(0,o.isInstanceOf)(t,y)?t.store:t)}),c||s(n),n}return r(t,[{key:"log",value:function(){console&&console.log((0,o.getMutableObject)(this))}}]),t}(),d=function(t,e,n){return n?t.$$store[n]=e:t.$$store=e,t.store=new h(t.$$store),f(t),e},b=function(t,e,n){return(0,o.bindFunction)(function(){for(var r=this,i=n?t.$$store[n]:t.$$store,u=arguments.length,s=Array(u),c=0;c<u;c++)s[c]=arguments[c];var a=e.apply(void 0,[i].concat(s));return(0,o.isFunction)(a.then)?a.then(function(t){return d(r,t,n)}):Promise.resolve(d(this,a,n))},t)},v=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,o.forEachObject)(n,function(e,n){var r;t.$$initialValues[n]=e,t.$$store[n]=(r=e,(0,o.isClassInstance)(r)?Object.create(Object.getPrototypeOf(r),Object.getOwnPropertyNames(r).reduce(function(t,e){return t[e]=Object.getOwnPropertyDescriptor(r,e),t},{})):(0,o.getClone)(r,h))}),(0,o.forEachObject)(e,function(e,n){(0,o.isFunction)(e)?t.$$actions[n]=b(t,e):(0,o.isObject)(e)&&(0,o.forEachObject)(e,function(e,r){t.$$actions[r]=b(t,e,n)})})},$=e.SingulumSnapshot=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2];return u(this,t),(0,o.forEachObject)(e,function(e,u){var s=r[u];(0,o.isInstanceOf)(s,y)?n[u]=i?new t(s.store,s.$$store,i):s:n[u]=(0,o.getClone)(s,h)}),this},g=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e||(e=a,a++),(0,o.setReadonly)(t,e,new y(n,r)),t.$$store[e]=t[e],t.store=new h(t.$$store),t[e]},y=e.Singulum=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(this,t),(0,o.setHidden)(this,"$$actions",[]),(0,o.setHidden)(this,"$$initialValues",{}),(0,o.setHidden)(this,"$$watchers",[]),(0,o.setHidden)(this,"$$snapshots",{}),(0,o.setHidden)(this,"$$store",{}),v(this,e,n),this.actions=c?this.$$actions:new l(this.$$actions),this.store=new h(this.$$store),this}return r(t,[{key:"branch",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];return n&&!(0,o.isString)(n)&&(n=n.toString()),g(this,n,t,e)}},{key:"equals",value:function(e,n){return n?(0,o.isEqual)(this.$$store[n],e,t):(0,o.isEqual)(this.$$store,e,t)}},{key:"hashCode",value:function(e){return e?(0,o.hashCode)(this.$$store[e],t):(0,o.hashCode)(this.$$store,t)}},{key:"reset",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r={};return(0,o.forEachObject)(this.$$store,function(i,u){(0,o.isInstanceOf)(i,t)?r[u]=n?i.reset():i:(0,o.isUndefined)(e.$$initialValues[u])||(r[u]=e.$$initialValues[u])}),this.$$store=r,this.store=new h(this.$$store),f(this),this}},{key:"restore",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,o.isInstanceOf)(e,$)||(0,o.throwError)("Snapshot used in restore method must be a SingulumSnapshot."),(0,o.forEachObject)(e,function(e,i){(0,o.isInstanceOf)(e,t)||((0,o.isInstanceOf)(e,$)?n.$$store[i]=r?n.$$store[i].restore(e,r):e:(0,o.isInstanceOf)(e,h)||(n.$$store[i]=(0,o.isInstanceOf)(e,t)?e.store:e))}),this.store=new h(this.$$store),f(this),this}},{key:"snapshot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new $(this.store,this.$$store,t)}},{key:"unwatch",value:function(t){var e=(0,o.findIndex)(this.$$watchers,function(e){return e===t});return this.$$watchers=[].concat(i(this.$$watchers.slice(0,e)),i(this.$$watchers.slice(e+1,this.$$watchers.length))),this}},{key:"watch",value:function(t){return(0,o.isFunction)(t)&&(this.$$watchers=[].concat(i(this.$$watchers),[t])),this}}]),t}();e.default=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.getMutableObject=m;var o=Object.defineProperty,i=Object.getOwnPropertyNames,u=Object.prototype.toString,s=e.isArray=function(t){return"[object Array]"===u.call(t)},c=e.isObject=function(t){return"[object Object]"===u.call(t)&&!!t},a=e.isClassInstance=function(t){return c(t)&&Object.getPrototypeOf(t).constructor!==Object.prototype.constructor},f=e.isDate=function(t){return"[object Date]"===u.call(t)},l=e.isFunction=function(t){return"[object Function]"===u.call(t)||"function"==typeof t},h=e.isInstanceOf=function(t,e){return t instanceof e},d=e.isProduction=function(){return!0},b=e.isString=function(t){return"[object String]"===u.call(t)},v=e.isUndefined=function(t){return void 0===t},$=e.bindFunction=function(t,e){return function(){for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.apply(e,r)}},g=e.findIndex=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n,t))return n;return-1},y=e.forEachObject=function(t,e){for(var n=Object.keys(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i,t)}},p=e.getClone=function t(e,n){if(s(e))return e.map(function(e){return t(e,n)});if(c(e)){var r={};return y(e,function(e,o){r[o]=t(e,n)}),h(e,n)&&(r=new n(r)),r}return f(e)?new Date(e.valueOf()):e},O=function(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e)||{},i=t[e];(s(i)||c(i))&&(i=m(i)),o(n,e,{configurable:!0,enumerable:r.enumerable||!0,value:i,writable:!0})};function m(t){var e=s(t);if(!e&!c(t))return t;var n=e?[]:{};return e?t.forEach(function(e,r){O(t,r,n)}):y(t,function(e,r){O(t,r,n)}),n}var j=e.serialize=function t(e,n){h(e,n)&&(e=e.store);var o=void 0===e?"undefined":r(e),i="";if("object"===o)for(var u in e)i+="{"+o+":"+u+t(e[u],n)+"}";else i+="function"===o?"{"+o+":"+e.toString()+"}":"{"+o+":"+e+"}";return i.replace(/\s/g,"")},w=e.hashCode=function(t,e){var n=j(t,e);if(""===n)return 0;for(var r=0,o=0,i=n.length;o<i;o++)r=(r<<5)-r+n.charCodeAt(o),r|=0;return r},S=e.isEqual=function(t,e,n){return w(t,n)===w(e,n)},E=e.setHidden=function(t,e,n){o(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0})},P=e.setImmutable=function t(e,n,r){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=void 0;switch(!0){case s(r):a=[],r.forEach(function(e,n){t(a,n,e)});break;case c(r):a={},i(r).forEach(function(e){t(a,e,r[e])});break;case f(r):a=r.valueOf();break;case l(r):a=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.apply(this,e)},y(r,function(e,n){r.hasOwnProperty(n)&&t(a,n,e)});break;default:a=r}return o(e,n,{configurable:!1,enumerable:u.enumerable||!0,get:function(){return a},set:function(){throw new SyntaxError("You are trying to set a value on an immutable object which is not allowed. Check the assignment of property "+n+".")}}),e[n]},I=e.throwError=function(t){throw new Error(t)},k=e.setReadonly=function(t,e,n){o(t,e,{get:function(){return n},set:function(){I("Cannot set a value for "+e+", as it is immutable.")}})};e.default={bindFunction:$,findIndex:g,forEachObject:y,getClone:p,getMutableObject:m,hashCode:w,isArray:s,isClassInstance:a,isDate:f,isEqual:S,isFunction:l,isInstanceOf:h,isObject:c,isProduction:d,isString:b,isUndefined:v,setHidden:E,setImmutable:P,setReadonly:k,throwError:I}}])});