/*!
 * Library: singulum
 * Description: State management sanity with minimal effort
 * Author: planttheidea
 * Version: 0.7.0
 * License: MIT
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("singulum",[],n):"object"==typeof exports?exports.singulum=n():t.singulum=n()}(this,function(){return function(t){function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){t.exports=e(1)},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(n,"__esModule",{value:!0});var i=e(2),o=r(i);n.default=new o.default,t.exports=n.default},function(t,n,e){"use strict";function r(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),u=e(3),s=Object.freeze,c=0,a=function(t){t.$$watchers.forEach(function(n){n(t.store)})},f=function(t,n,e){return e?t.$$store[e]=n:t.$$store=n,a(t),n},h=function(t,n,e){return(0,u.bindFunction)(function(){for(var r=this,i=e?t.$$store[e]:t.$$store,o=arguments.length,s=Array(o),c=0;o>c;c++)s[c]=arguments[c];var a=n.apply(void 0,[i].concat(s));return(0,u.isFunction)(a.then)?a.then(function(t){return f(r,t,e)}):Promise.resolve(f(this,a,e))},t)},l=function(t,n){var e=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return n||(n=c,c++),(0,u.setReadonly)(t,n,new g(e,r)),t.$$store[n]=t[n],t[n]},d=function(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],e=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,u.forEachObject)(e,function(n,e){t.$$initialValues[e]=(0,u.getClone)(n,y),t.$$store[e]=(0,u.getClone)(n,y)}),(0,u.forEachObject)(n,function(n,e){(0,u.isFunction)(n)?t.$$actions[e]=h(t,n):(0,u.isObject)(n)&&(0,u.forEachObject)(n,function(n,r){t.$$actions[r]=h(t,n,e)})})},$=function(t,n){return(0,u.getClone)(t.$$store[n],y)},v=function p(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return i(this,p),(0,u.forEachObject)(n,function(n,e){t[e]=n}),s(this),this},y=function j(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return i(this,j),(0,u.forEachObject)(n,function(n,e){t[e]=(0,u.isInstanceOf)(n,g)?n.store:n}),s(this),this},b=function O(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=this,e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments[2];return i(this,O),(0,u.forEachObject)(t,function(t,i){var o=e[i];n[i]=(0,u.isInstanceOf)(o,g)&&r?new O(o.store,o.$$store,r):(0,u.getClone)(o,y)}),this},g=function(){function t(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return i(this,t),(0,u.setHidden)(this,"$$actions",[]),(0,u.setHidden)(this,"$$initialValues",{}),(0,u.setHidden)(this,"$$watchers",[]),(0,u.setHidden)(this,"$$snapshots",{}),(0,u.setHidden)(this,"$$store",{}),d(this,n,e),this}return o(t,[{key:"branch",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],e=arguments[2];return e&&!(0,u.isString)(e)&&(e=e.toString()),l(this,e,t,n)}},{key:"equals",value:function(t,n){return n?(0,u.isEqual)(this.$$store[n],t[n]):(0,u.isEqual)(this.$$store,t)}},{key:"hashCode",value:function(t){return t?(0,u.hashCode)(this.$$store[t]):(0,u.hashCode)(this.$$store)}},{key:"pluck",value:function(t){var n=this;return t?(0,u.isString)(t)?$(this,t):(0,u.isArray)(t)?t.map(function(t){return $(n,t)}):void 0:this.store}},{key:"reset",value:function(){var n=this,e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],r={};return(0,u.forEachObject)(this.$$store,function(i,o){(0,u.isInstanceOf)(i,t)&&e?i.reset():(0,u.isInstanceOf)(i,b)||(r[o]=n.$$initialValues[o])}),this.$$store=r,a(this),this}},{key:"restore",value:function(t){var n=this,e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return(0,u.isInstanceOf)(t,b)||(0,u.throwError)("Snapshot used in restore method must be a SingulumSnapshot."),(0,u.forEachObject)(t,function(t,r){(0,u.isInstanceOf)(t,b)&&e?n.$$store[r].restore(t,e):(0,u.isInstanceOf)(t,y)||(n.$$store[r]=t)}),a(this),this}},{key:"snapshot",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return new b(this.store,this.$$store,t)}},{key:"unwatch",value:function(t){var n=(0,u.findIndex)(this.$$watchers,function(n){return n===t});return this.$$watchers=[].concat(r(this.$$watchers.slice(0,n)),r(this.$$watchers.slice(n+1,this.$$watchers.length))),this}},{key:"watch",value:function(t){return(0,u.isFunction)(t)&&(this.$$watchers=[].concat(r(this.$$watchers),[t])),this}},{key:"actions",get:function(){return new v(this.$$actions)}},{key:"store",get:function(){return new y(this.$$store)}}]),t}();n.default=g,t.exports=n.default},function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},r=Object.prototype.toString,i=n.bindFunction=function(t,n){return function(){for(var e=arguments.length,r=Array(e),i=0;e>i;i++)r[i]=arguments[i];return t.apply(n,r)}},o=n.findIndex=function(t,n){for(var e=0,r=t.length;r>e;e++)if(n(t[e],e,t))return e;return-1},u=n.forEachObject=function(t,n){for(var e=Object.keys(t),r=0,i=e.length;i>r;r++){var o=e[r];n(t[o],o,t)}},s=n.getClone=function j(t,n){if(a(t))return t.map(function(t){return j(t,n)});if($(t)){var r=function(){var e={};return u(t,function(t,r){e[r]=j(t,n)}),d(t,n)&&(e=new n(e)),{v:e}}();if("object"===("undefined"==typeof r?"undefined":e(r)))return r.v}return f(t)?new Date(t.valueOf()):t},c=n.hashCode=function O(t){var n=b(t);if(""===n)return 0;for(var O=0,e=void 0,r=0,i=n.length;i>r;r++)e=n.charCodeAt(r),O=(O<<5)-O+e,O|=0;return O},a=n.isArray=function(t){return"[object Array]"===r.call(t)},f=function(t){return"[object Date]"===r.call(t)},h=n.isEqual=function(t,n){return c(t)===c(n)},l=n.isFunction=function(t){return"[object Function]"===r.call(t)||"function"==typeof t},d=n.isInstanceOf=function(t,n){return t instanceof n},$=n.isObject=function(t){return"[object Object]"===r.call(t)&&!!t},v=n.isString=function(t){return"[object String]"===r.call(t)},y=n.setHidden=function(t,n,e){Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value:e,writable:!0})},b=function w(t){var n="undefined"==typeof t?"undefined":e(t),r="";if("object"===n)for(var i in t)r+="{"+n+":"+i+w(t[i])+"}";else r+="function"===n?"{"+n+":"+t.toString()+"}":"{"+n+":"+t+"}";return r.replace(/\s/g,"")},g=n.setReadonly=function(t,n,e){Object.defineProperty(t,n,{get:function(){return e},set:function(){p("Cannot set a value for "+n+", as it is immutable.")}})},p=n.throwError=function(t){throw new Error(t)};n.default={bindFunction:i,findIndex:o,forEachObject:u,getClone:s,hashCode:c,isArray:a,isEqual:h,isFunction:l,isInstanceOf:d,isObject:$,isString:v,setHidden:y,setReadonly:g,throwError:p}}])});