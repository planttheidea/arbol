/*!
 * Library: singulum
 * Description: manage your JavaScript application state with predictability and minimal boilerplate
 * Author: Tony Quetano
 * License: MIT
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("singulum",[],n):"object"==typeof exports?exports.singulum=n():t.singulum=n()}(this,function(){return function(t){function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){t.exports=e(1)},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(n,"__esModule",{value:!0});var i=e(2),o=r(i);n.default=new o.default,t.exports=n.default},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e(3),o=Object.assign,s=function(t,n,e){return t.$$store[n]=e,(0,i.isFunction)(t.$$listener)&&t.$$listener(t.store),e},u=function(t,n,e){return(0,i.bindFunction)(function(){var t=this,r=n.apply(void 0,arguments);return r.then?r.then(function(n){return s(t,e,n)}):Promise.resolve(s(this,e,r))},t)},c=function(t,n,e){return(0,i.setReadonly)(t,n,new d(e)),t.$$store[n]=t[n],t[n]},a=function(t,n,e){(0,i.isObject)(e)||(0,i.throwError)("Must provide a map of leaves to branch."),t.$$initialValues[n]=(0,i.getClone)(e.initialValue,l),t.$$store[n]=(0,i.getClone)(e.initialValue,l),(0,i.forEachObject)(e,function(e,r){"initialValue"!==r&&(0,i.isFunction)(e)&&(t.$$actions[r]=u(t,e,n))})},f=function $(t){return r(this,$),o(this,t),this},l=function b(t){var n=this;return r(this,b),(0,i.forEachObject)(t,function(t,e){n[e]=(0,i.isInstanceOf)(t,d)?t.store:t}),this},h=function p(t,n,e){var o=this;return r(this,p),(0,i.forEachObject)(t,function(t,r){var s=n[r];o[r]=(0,i.isInstanceOf)(s,d)&&e?new p(s.store,s.$$store,e):(0,i.getClone)(s,l)}),this},d=function g(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return r(this,g),(0,i.setHidden)(this,"$$actions",[]),(0,i.setHidden)(this,"$$initialValues",{}),(0,i.setHidden)(this,"$$listener",null),(0,i.setHidden)(this,"$$snapshots",{}),(0,i.setHidden)(this,"$$store",{}),(0,i.forEachObject)(n,function(n,e){a(t,e,n)}),this};d.prototype=Object.create({get actions(){return new f(this.$$actions)},get store(){return new l(this.$$store)},branch:function(t,n){return(0,i.isString)(t)||(t=t.toString()),n?c(this,t,n):this[t]},branches:function m(t){var n=this,m=[];return(0,i.isArray)(t)?(t.forEach(function(t){(0,i.isString)(t)&&m.push(n[t])}),m):((0,i.forEachObject)(t,function(t,e){m.push(c(n,e,t))}),m)},reset:function(){var t=this,n=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return(0,i.forEachObject)(this.$$store,function(e,r){(0,i.isInstanceOf)(e,d)&&n?e.reset():(0,i.isInstanceOf)(e,h)||(t.$$store[r]=t.$$initialValues[r])}),(0,i.isFunction)(this.$$listener)&&this.$$listener(this.store),this},restore:function(t){var n=this,e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return(0,i.isInstanceOf)(t,h)||(0,i.throwError)("Snapshot used in restore method must be a SingulumSnapshot."),(0,i.forEachObject)(t,function(t,r){(0,i.isInstanceOf)(t,h)&&e?n.$$store[r].restore(t,e):(0,i.isInstanceOf)(t,l)||(n.$$store[r]=t)}),(0,i.isFunction)(this.$$listener)&&this.$$listener(this.store),this},snapshot:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return new h(this.store,this.$$store,t)},unwatch:function(){return this.$$listener=null,this},watch:function(t){return(0,i.isFunction)(t)&&(this.$$listener=t),this}}),n.default=d,t.exports=n.default},function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},r=Object.prototype.toString,i=n.bindFunction=function(t,n){return function(){for(var e=arguments.length,r=Array(e),i=0;e>i;i++)r[i]=arguments[i];return t.apply(n,r)}},o=n.forEachObject=function(t,n){for(var e=Object.keys(t),r=0,i=e.length;i>r;r++){var o=e[r];n(t[o],o,t)}},s=n.isArray=function(t){return"[object Array]"===r.call(t)},u=function(t){return"[object Date]"===r.call(t)},c=n.isFunction=function(t){return"[object Function]"===r.call(t)||"function"==typeof t},a=n.isInstanceOf=function(t,n){return t instanceof n},f=n.isObject=function(t){return"[object Object]"===r.call(t)&&!!t},l=n.isString=function(t){return"[object String]"===r.call(t)},h=n.getClone=function p(t,n){if(s(t))return t.map(function(t){return p(t,n)});if(f(t)){var r=function(){var e={};return o(t,function(t,r){e[r]=p(t,n)}),a(t,n)&&(e=new n(e)),{v:e}}();if("object"===("undefined"==typeof r?"undefined":e(r)))return r.v}return u(t)?new Date(t.valueOf()):t},d=n.setHidden=function(t,n,e){Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value:e,writable:!0})},$=n.setReadonly=function(t,n,e){Object.defineProperty(t,n,{get:function(){return e},set:function(){b("Cannot set a value for "+n+", as it is immutable.")}})},b=n.throwError=function(t){throw new Error(t)};n.default={bindFunction:i,forEachObject:o,getClone:h,isArray:s,isFunction:c,isInstanceOf:a,isObject:f,isString:l,setHidden:d,setReadonly:$,throwError:b}}])});