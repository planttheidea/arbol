/*!
 * Library: singulum
 * Description: State management sanity with minimal effort
 * Author: planttheidea
 * Version: 0.5.2
 * License: MIT
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("singulum",[],n):"object"==typeof exports?exports.singulum=n():t.singulum=n()}(this,function(){return function(t){function n(r){if(e[r])return e[r].exports;var s=e[r]={exports:{},id:r,loaded:!1};return t[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){t.exports=e(1)},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(n,"__esModule",{value:!0});var s=e(2),i=r(s);n.default=new i.default,t.exports=n.default},function(t,n,e){"use strict";function r(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}function s(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e(3),o=Object.assign,u=Object.freeze,a=0,c=function(t,n,e){return e?t.$$store[e]=n:t.$$store=n,t.$$watchers.length&&t.$$watchers.forEach(function(n){n(t.store)}),n},f=function(t,n,e){return(0,i.bindFunction)(function(){var t=this,r=n.apply(void 0,arguments);return(0,i.isFunction)(r.then)?r.then(function(n){return c(t,n,e)}):Promise.resolve(c(this,r,e))},t)},h=function(t,n){var e=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return n||(n=a,a++),(0,i.setReadonly)(t,n,new v(e,r)),t.$$store[n]=t[n],t[n]},g=function(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],e=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,i.forEachObject)(e,function(n,e){t.$$initialValues[e]=(0,i.getClone)(n,m),t.$$store[e]=(0,i.getClone)(n,m)}),(0,i.forEachObject)(n,function(n,e){(0,i.isFunction)(n)?t.$$actions[e]=f(t,n):(0,i.isObject)(n)&&(0,i.forEachObject)(n,function(n,r){t.$$actions[r]=f(t,n,e)})})},l=function(t,n){return(0,i.getClone)(t.$$store[n],m)},d=function b(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return s(this,b),o(this,t),u(this),this},m=function p(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return s(this,p),(0,i.forEachObject)(n,function(n,e){t[e]=(0,i.isInstanceOf)(n,v)?n.store:n}),u(this),this},$=function y(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=this,e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments[2];return s(this,y),(0,i.forEachObject)(t,function(t,s){var o=e[s];n[s]=(0,i.isInstanceOf)(o,v)&&r?new y(o.store,o.$$store,r):(0,i.getClone)(o,m)}),this},v=function j(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return s(this,j),(0,i.setHidden)(this,"$$actions",[]),(0,i.setHidden)(this,"$$initialValues",{}),(0,i.setHidden)(this,"$$watchers",[]),(0,i.setHidden)(this,"$$snapshots",{}),(0,i.setHidden)(this,"$$store",{}),g(this,t,n),this};v.prototype=Object.create({get actions(){return new d(this.$$actions)},get store(){return new m(this.$$store)},branch:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],e=arguments[2];return e&&!(0,i.isString)(e)&&(e=e.toString()),h(this,e,t,n)},pluck:function(t){var n=this;return t?(0,i.isString)(t)?l(this,t):(0,i.isArray)(t)?t.map(function(t){return l(n,t)}):void 0:this.store},reset:function(){var t=this,n=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],e={};return(0,i.forEachObject)(this.$$store,function(r,s){(0,i.isInstanceOf)(r,v)&&n?r.reset():(0,i.isInstanceOf)(r,$)||(e[s]=t.$$initialValues[s])}),this.$$store=e,(0,i.isFunction)(this.$$watchers)&&this.$$watchers(this.store),this},restore:function(t){var n=this,e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return(0,i.isInstanceOf)(t,$)||(0,i.throwError)("Snapshot used in restore method must be a SingulumSnapshot."),(0,i.forEachObject)(t,function(t,r){(0,i.isInstanceOf)(t,$)&&e?n.$$store[r].restore(t,e):(0,i.isInstanceOf)(t,m)||(n.$$store[r]=t)}),(0,i.isFunction)(this.$$watchers)&&this.$$watchers(this.store),this},snapshot:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return new $(this.store,this.$$store,t)},unwatch:function(t){var n=(0,i.findIndex)(this.$$watchers,function(n){return n===t});return this.$$watchers=[].concat(r(this.$$watchers.slice(0,n)),r(this.$$watchers.slice(n+1,this.$$watchers.length))),this},watch:function(t){return(0,i.isFunction)(t)&&(this.$$watchers=[].concat(r(this.$$watchers),[t])),this}}),n.default=v,t.exports=n.default},function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},r=Object.prototype.toString,s=n.bindFunction=function(t,n){return function(){for(var e=arguments.length,r=Array(e),s=0;e>s;s++)r[s]=arguments[s];return t.apply(n,r)}},i=n.findIndex=function(t,n){for(var e=0,r=t.length;r>e;e++)if(n(t[e],e,t))return e},o=n.forEachObject=function(t,n){for(var e=Object.keys(t),r=0,s=e.length;s>r;r++){var i=e[r];n(t[i],i,t)}},u=n.isArray=function(t){return"[object Array]"===r.call(t)},a=function(t){return"[object Date]"===r.call(t)},c=n.isFunction=function(t){return"[object Function]"===r.call(t)||"function"==typeof t},f=n.isInstanceOf=function(t,n){return t instanceof n},h=n.isObject=function(t){return"[object Object]"===r.call(t)&&!!t},g=n.isString=function(t){return"[object String]"===r.call(t)},l=n.getClone=function v(t,n){if(u(t))return t.map(function(t){return v(t,n)});if(h(t)){var r=function(){var e={};return o(t,function(t,r){e[r]=v(t,n)}),f(t,n)&&(e=new n(e)),{v:e}}();if("object"===("undefined"==typeof r?"undefined":e(r)))return r.v}return a(t)?new Date(t.valueOf()):t},d=n.setHidden=function(t,n,e){Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value:e,writable:!0})},m=n.setReadonly=function(t,n,e){Object.defineProperty(t,n,{get:function(){return e},set:function(){$("Cannot set a value for "+n+", as it is immutable.")}})},$=n.throwError=function(t){throw new Error(t)};n.default={bindFunction:s,findIndex:i,forEachObject:o,getClone:l,isArray:u,isFunction:c,isInstanceOf:f,isObject:h,isString:g,setHidden:d,setReadonly:m,throwError:$}}])});