/*!
 * Library: singulum
 * Description: State management sanity with minimal effort
 * Author: planttheidea
 * Version: 1.0.0
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("singulum",[],e):"object"==typeof exports?exports.singulum=e():t.singulum=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),i=r(o);e.default=new i.default,t.exports=e.default},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.SingulumStore=e.SingulumSnapshot=e.SingulumActions=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(3),u=Object.freeze,c=(0,s.isProduction)(),a=0,f=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e||(e=a,a++),(0,s.setReadonly)(t,e,new p(n,r)),t.$$store[e]=t[e],t.store=new g(t.$$store),t[e]},l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,s.forEachObject)(n,function(e,n){t.$$initialValues[n]=e,t.$$store[n]=$(e)}),(0,s.forEachObject)(e,function(e,n){(0,s.isFunction)(e)?t.$$actions[n]=h(t,e):(0,s.isObject)(e)&&(0,s.forEachObject)(e,function(e,r){t.$$actions[r]=h(t,e,n)})})},h=function(t,e,n){return(0,s.bindFunction)(function(){for(var r=this,o=n?t.$$store[n]:t.$$store,i=arguments.length,u=Array(i),c=0;c<i;c++)u[c]=arguments[c];var a=e.apply(void 0,[o].concat(u));return(0,s.isFunction)(a.then)?a.then(function(t){return v(r,t,n)}):Promise.resolve(v(this,a,n))},t)},d=function(t){t.$$watchers.forEach(function(e){e(t.store)})},$=function(t){var e=(0,s.isClassInstance)(t);return e?Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyNames(t).reduce(function(e,n){return e[n]=Object.getOwnPropertyDescriptor(t,n),e},{})):(0,s.getClone)(t,g)},v=function(t,e,n){return n?t.$$store[n]=e:t.$$store=e,t.store=new g(t.$$store),d(t),e},b=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=c?{}:this;return(0,s.forEachObject)(e,function(t,r){(0,s.setImmutable)(n,r,e[r])}),c||u(n),n}return i(t,[{key:"log",value:function(){console}}]),t}(),g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=c?{}:this;return(0,s.forEachObject)(e,function(t,e){(0,s.setImmutable)(n,e,(0,s.isInstanceOf)(t,p)?t.store:t)}),c||u(n),n}return i(t,[{key:"log",value:function(){console}}]),t}(),y=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2];return o(this,t),(0,s.forEachObject)(e,function(e,o){var u=r[o];(0,s.isInstanceOf)(u,p)?n[o]=i?new t(u.store,u.$$store,i):u:n[o]=(0,s.getClone)(u,g)}),this},p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,t),(0,s.setHidden)(this,"$$actions",[]),(0,s.setHidden)(this,"$$initialValues",{}),(0,s.setHidden)(this,"$$watchers",[]),(0,s.setHidden)(this,"$$snapshots",{}),(0,s.setHidden)(this,"$$store",{}),l(this,e,n),this.actions=c?this.$$actions:new b(this.$$actions),this.store=new g(this.$$store),this}return i(t,[{key:"branch",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];return n&&!(0,s.isString)(n)&&(n=n.toString()),f(this,n,t,e)}},{key:"equals",value:function(e,n){return n?(0,s.isEqual)(this.$$store[n],e,t):(0,s.isEqual)(this.$$store,e,t)}},{key:"hashCode",value:function(e){return e?(0,s.hashCode)(this.$$store[e],t):(0,s.hashCode)(this.$$store,t)}},{key:"reset",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r={};return(0,s.forEachObject)(this.$$store,function(o,i){(0,s.isInstanceOf)(o,t)?r[i]=n?o.reset():o:(0,s.isUndefined)(e.$$initialValues[i])||(r[i]=e.$$initialValues[i])}),this.$$store=r,this.store=new g(this.$$store),d(this),this}},{key:"restore",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,s.isInstanceOf)(e,y)||(0,s.throwError)("Snapshot used in restore method must be a SingulumSnapshot."),(0,s.forEachObject)(e,function(e,o){(0,s.isInstanceOf)(e,t)||((0,s.isInstanceOf)(e,y)?n.$$store[o]=r?n.$$store[o].restore(e,r):e:(0,s.isInstanceOf)(e,g)||(n.$$store[o]=(0,s.isInstanceOf)(e,t)?e.store:e))}),this.store=new g(this.$$store),d(this),this}},{key:"snapshot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new y(this.store,this.$$store,t)}},{key:"unwatch",value:function(t){var e=(0,s.findIndex)(this.$$watchers,function(e){return e===t});return this.$$watchers=[].concat(r(this.$$watchers.slice(0,e)),r(this.$$watchers.slice(e+1,this.$$watchers.length))),this}},{key:"watch",value:function(t){return(0,s.isFunction)(t)&&(this.$$watchers=[].concat(r(this.$$watchers),[t])),this}}]),t}();e.SingulumActions=b,e.SingulumSnapshot=y,e.SingulumStore=g,e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=Object.defineProperty,i=Object.getOwnPropertyNames,s=Object.prototype.toString,u=e.bindFunction=function(t,e){return function(){for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.apply(e,r)}},c=e.findIndex=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n,t))return n;return-1},a=e.forEachObject=function(t,e){for(var n=Object.keys(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i,t)}},f=e.getClone=function t(e,n){if(d(e))return e.map(function(e){return t(e,n)});if(p(e)){var r={};return a(e,function(e,o){r[o]=t(e,n)}),y(e,n)&&(r=new n(r)),r}return v(e)?new Date(e.valueOf()):e},l=e.getMutableObject=function(t){var e=d(t);if(!e&!p(t))return t;var n=e?[]:{};return e?t.forEach(function(e,r){E(t,r,n)}):a(t,function(e,r){E(t,r,n)}),n},h=e.hashCode=function t(e,n){var r=S(e,n);if(""===r)return 0;for(var t=0,o=void 0,i=0,s=r.length;i<s;i++)o=r.charCodeAt(i),t=(t<<5)-t+o,t|=0;return t},d=e.isArray=function(t){return"[object Array]"===s.call(t)},$=e.isClassInstance=function(t){return p(t)&&Object.getPrototypeOf(t).constructor!==Object.prototype.constructor},v=e.isDate=function(t){return"[object Date]"===s.call(t)},b=e.isEqual=function(t,e,n){return h(t,n)===h(e,n)},g=e.isFunction=function(t){return"[object Function]"===s.call(t)||"function"==typeof t},y=e.isInstanceOf=function(t,e){return t instanceof e},p=e.isObject=function(t){return"[object Object]"===s.call(t)&&!!t},O=e.isProduction=function(){return!0},m=e.isString=function(t){return"[object String]"===s.call(t)},w=e.isUndefined=function(t){return void 0===t},j=e.setHidden=function(t,e,n){o(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0})},S=function t(e,n){y(e,n)&&(e=e.store);var o="undefined"==typeof e?"undefined":r(e),i="";if("object"===o)for(var s in e)i+="{"+o+":"+s+t(e[s],n)+"}";else i+="function"===o?"{"+o+":"+e.toString()+"}":"{"+o+":"+e+"}";return i.replace(/\s/g,"")},E=function(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e)||{},i=t[e];(d(i)||p(i))&&(i=l(i)),o(n,e,{configurable:!0,enumerable:r.enumerable||!0,value:i,writable:!0})},I=e.setImmutable=function t(e,n,r){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=void 0;switch(!0){case d(r):u=[],r.forEach(function(e,n){t(u,n,e)});break;case p(r):u={},i(r).forEach(function(e){t(u,e,r[e])});break;case v(r):u=r.valueOf();break;case g(r):u=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.apply(this,e)},a(r,function(e,n){r.hasOwnProperty(n)&&t(u,n,e)});break;default:u=r}return o(e,n,{get:function(){return u},set:function(){throw new SyntaxError("You are trying to set a value on an immutable object which is not allowed. Check the assignment of property "+n+".")},configurable:!1,enumerable:s.enumerable||!0}),e[n]},k=e.setReadonly=function(t,e,n){o(t,e,{get:function(){return n},set:function(){C("Cannot set a value for "+e+", as it is immutable.")}})},C=e.throwError=function(t){throw new Error(t)};e.default={bindFunction:u,findIndex:c,forEachObject:a,getClone:f,getMutableObject:l,hashCode:h,isArray:d,isClassInstance:$,isDate:v,isEqual:b,isFunction:g,isInstanceOf:y,isObject:p,isProduction:O,isString:m,isUndefined:w,setHidden:j,setImmutable:I,setReadonly:k,throwError:C}}])});