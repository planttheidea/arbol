/*!
 * Library: singulum
 * Description: State management sanity with minimal effort
 * Author: planttheidea
 * Version: 0.7.0
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("singulum",[],e):"object"==typeof exports?exports.singulum=e():t.singulum=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),i=r(o);e.default=new i.default,t.exports=e.default},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(3),u=Object.freeze,c=0,a=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return e||(e=c,c++),(0,s.setReadonly)(t,e,new g(n,r)),t.$$store[e]=t[e],t[e]},f=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,s.forEachObject)(n,function(e,n){t.$$initialValues[n]=e,t.$$store[n]=d(e)}),(0,s.forEachObject)(e,function(e,n){(0,s.isFunction)(e)?t.$$actions[n]=h(t,e):(0,s.isObject)(e)&&(0,s.forEachObject)(e,function(e,r){t.$$actions[r]=h(t,e,n)})})},h=function(t,e,n){return(0,s.bindFunction)(function(){for(var r=this,o=n?t.$$store[n]:t.$$store,i=arguments.length,u=Array(i),c=0;i>c;c++)u[c]=arguments[c];var a=e.apply(void 0,[o].concat(u));return(0,s.isFunction)(a.then)?a.then(function(t){return v(r,t,n)}):Promise.resolve(v(this,a,n))},t)},l=function(t){t.$$watchers.forEach(function(e){e(t.store)})},d=function(t){var e=(0,s.isClassInstance)(t);return e?Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyNames(t).reduce(function(e,n){return e[n]=Object.getOwnPropertyDescriptor(t,n),e},{})):(0,s.getClone)(t,b)},$=function(t,e){return(0,s.getClone)(t.$$store[e],b)},v=function(t,e,n){return n?t.$$store[n]=e:t.$$store=e,l(t),e},y=function O(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return o(this,O),(0,s.forEachObject)(e,function(e,n){t[n]=e}),u(this),this},b=function j(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return o(this,j),(0,s.forEachObject)(e,function(e,n){t[n]=(0,s.isInstanceOf)(e,g)?e.store:e}),u(this),this},p=function w(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments[2];return o(this,w),(0,s.forEachObject)(t,function(t,o){var i=n[o];e[o]=(0,s.isInstanceOf)(i,g)&&r?new w(i.store,i.$$store,r):(0,s.getClone)(i,b)}),this},g=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return o(this,t),(0,s.setHidden)(this,"$$actions",[]),(0,s.setHidden)(this,"$$initialValues",{}),(0,s.setHidden)(this,"$$watchers",[]),(0,s.setHidden)(this,"$$snapshots",{}),(0,s.setHidden)(this,"$$store",{}),f(this,e,n),this}return i(t,[{key:"branch",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments[2];return n&&!(0,s.isString)(n)&&(n=n.toString()),a(this,n,t,e)}},{key:"equals",value:function(t,e){return e?(0,s.isEqual)(this.$$store[e],t[e]):(0,s.isEqual)(this.$$store,t)}},{key:"hashCode",value:function(t){return t?(0,s.hashCode)(this.$$store[t]):(0,s.hashCode)(this.$$store)}},{key:"pluck",value:function(t){var e=this;return t?(0,s.isString)(t)?$(this,t):(0,s.isArray)(t)?t.map(function(t){return $(e,t)}):void 0:this.store}},{key:"reset",value:function(){var e=this,n=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],r={};return(0,s.forEachObject)(this.$$store,function(o,i){(0,s.isInstanceOf)(o,t)&&n?o.reset():(0,s.isInstanceOf)(o,p)||(r[i]=e.$$initialValues[i])}),this.$$store=r,l(this),this}},{key:"restore",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return(0,s.isInstanceOf)(t,p)||(0,s.throwError)("Snapshot used in restore method must be a SingulumSnapshot."),(0,s.forEachObject)(t,function(t,r){(0,s.isInstanceOf)(t,p)&&n?e.$$store[r].restore(t,n):(0,s.isInstanceOf)(t,b)||(e.$$store[r]=t)}),l(this),this}},{key:"snapshot",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return new p(this.store,this.$$store,t)}},{key:"unwatch",value:function(t){var e=(0,s.findIndex)(this.$$watchers,function(e){return e===t});return this.$$watchers=[].concat(r(this.$$watchers.slice(0,e)),r(this.$$watchers.slice(e+1,this.$$watchers.length))),this}},{key:"watch",value:function(t){return(0,s.isFunction)(t)&&(this.$$watchers=[].concat(r(this.$$watchers),[t])),this}},{key:"actions",get:function(){return new y(this.$$actions)}},{key:"store",get:function(){return new b(this.$$store)}}]),t}();e.default=g,t.exports=e.default},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},r=Object.prototype.toString,o=e.bindFunction=function(t,e){return function(){for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];return t.apply(e,r)}},i=e.findIndex=function(t,e){for(var n=0,r=t.length;r>n;n++)if(e(t[n],n,t))return n;return-1},s=e.forEachObject=function(t,e){for(var n=Object.keys(t),r=0,o=n.length;o>r;r++){var i=n[r];e(t[i],i,t)}},u=e.getClone=function j(t,e){if(a(t))return t.map(function(t){return j(t,e)});if(v(t)){var r=function(){var n={};return s(t,function(t,r){n[r]=j(t,e)}),$(t,e)&&(n=new e(n)),{v:n}}();if("object"===("undefined"==typeof r?"undefined":n(r)))return r.v}return h(t)?new Date(t.valueOf()):t},c=e.hashCode=function w(t){var e=p(t);if(""===e)return 0;for(var w=0,n=void 0,r=0,o=e.length;o>r;r++)n=e.charCodeAt(r),w=(w<<5)-w+n,w|=0;return w},a=e.isArray=function(t){return"[object Array]"===r.call(t)},f=e.isClassInstance=function(t){return v(t)&&Object.getPrototypeOf(t).constructor!==Object.prototype.constructor},h=function(t){return"[object Date]"===r.call(t)},l=e.isEqual=function(t,e){return c(t)===c(e)},d=e.isFunction=function(t){return"[object Function]"===r.call(t)||"function"==typeof t},$=e.isInstanceOf=function(t,e){return t instanceof e},v=e.isObject=function(t){return"[object Object]"===r.call(t)&&!!t},y=e.isString=function(t){return"[object String]"===r.call(t)},b=e.setHidden=function(t,e,n){Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0})},p=function m(t){var e="undefined"==typeof t?"undefined":n(t),r="";if("object"===e)for(var o in t)r+="{"+e+":"+o+m(t[o])+"}";else r+="function"===e?"{"+e+":"+t.toString()+"}":"{"+e+":"+t+"}";return r.replace(/\s/g,"")},g=e.setReadonly=function(t,e,n){Object.defineProperty(t,e,{get:function(){return n},set:function(){O("Cannot set a value for "+e+", as it is immutable.")}})},O=e.throwError=function(t){throw new Error(t)};e.default={bindFunction:o,findIndex:i,forEachObject:s,getClone:u,hashCode:c,isArray:a,isClassInstance:f,isEqual:l,isFunction:d,isInstanceOf:$,isObject:v,isString:y,setHidden:b,setReadonly:g,throwError:O}}])});