/*!
 * Library: singulum
 * Description: State management sanity with minimal effort
 * Author: planttheidea
 * Version: 1.0.0
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("singulum",[],e):"object"==typeof exports?exports.singulum=e():t.singulum=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),i=r(o);e.default=new i.default,t.exports=e.default},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.SingulumStore=e.SingulumSnapshot=e.SingulumActions=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(3),s=Object.freeze,c=(0,u.isProduction)(),a=0,f=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return e||(e=a,a++),(0,u.setReadonly)(t,e,new p(n,r)),t.$$store[e]=t[e],t.store=new g(t.$$store),t[e]},l=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,u.forEachObject)(n,function(e,n){t.$$initialValues[n]=e,t.$$store[n]=v(e)}),(0,u.forEachObject)(e,function(e,n){(0,u.isFunction)(e)?t.$$actions[n]=h(t,e):(0,u.isObject)(e)&&(0,u.forEachObject)(e,function(e,r){t.$$actions[r]=h(t,e,n)})})},h=function(t,e,n){return(0,u.bindFunction)(function(){for(var r=this,o=n?t.$$store[n]:t.$$store,i=arguments.length,s=Array(i),c=0;i>c;c++)s[c]=arguments[c];var a=e.apply(void 0,[o].concat(s));return(0,u.isFunction)(a.then)?a.then(function(t){return $(r,t,n)}):Promise.resolve($(this,a,n))},t)},d=function(t){t.$$watchers.forEach(function(e){e(t.store)})},v=function(t){var e=(0,u.isClassInstance)(t);return e?Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyNames(t).reduce(function(e,n){return e[n]=Object.getOwnPropertyDescriptor(t,n),e},{})):(0,u.getClone)(t,g)},$=function(t,e,n){return n?t.$$store[n]=e:t.$$store=e,t.store=new g(t.$$store),d(t),e},b=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,t);var n=c?{}:this;return(0,u.forEachObject)(e,function(t,r){(0,u.setImmutable)(n,r,e[r])}),c||s(n),n}return i(t,[{key:"log",value:function(){console}}]),t}(),g=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,t);var n=c?{}:this;return(0,u.forEachObject)(e,function(t,e){(0,u.setImmutable)(n,e,(0,u.isInstanceOf)(t,p)?t.store:t)}),c||s(n),n}return i(t,[{key:"log",value:function(){console}}]),t}(),y=function O(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments[2];return o(this,O),(0,u.forEachObject)(t,function(t,o){var i=n[o];(0,u.isInstanceOf)(i,p)?e[o]=r?new O(i.store,i.$$store,r):i:e[o]=(0,u.getClone)(i,g)}),this},p=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return o(this,t),(0,u.setHidden)(this,"$$actions",[]),(0,u.setHidden)(this,"$$initialValues",{}),(0,u.setHidden)(this,"$$watchers",[]),(0,u.setHidden)(this,"$$snapshots",{}),(0,u.setHidden)(this,"$$store",{}),l(this,e,n),this.actions=c?this.$$actions:new b(this.$$actions),this.store=new g(this.$$store),this}return i(t,[{key:"branch",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments[2];return n&&!(0,u.isString)(n)&&(n=n.toString()),f(this,n,t,e)}},{key:"equals",value:function(e,n){return n?(0,u.isEqual)(this.$$store[n],e,t):(0,u.isEqual)(this.$$store,e,t)}},{key:"hashCode",value:function(e){return e?(0,u.hashCode)(this.$$store[e],t):(0,u.hashCode)(this.$$store,t)}},{key:"reset",value:function(){var e=this,n=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],r={};return(0,u.forEachObject)(this.$$store,function(o,i){(0,u.isInstanceOf)(o,t)?r[i]=n?o.reset():o:(0,u.isUndefined)(e.$$initialValues[i])||(r[i]=e.$$initialValues[i])}),this.$$store=r,this.store=new g(this.$$store),d(this),this}},{key:"restore",value:function(e){var n=this,r=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return(0,u.isInstanceOf)(e,y)||(0,u.throwError)("Snapshot used in restore method must be a SingulumSnapshot."),(0,u.forEachObject)(e,function(e,o){(0,u.isInstanceOf)(e,t)||((0,u.isInstanceOf)(e,y)?n.$$store[o]=r?n.$$store[o].restore(e,r):e:(0,u.isInstanceOf)(e,g)||(n.$$store[o]=(0,u.isInstanceOf)(e,t)?e.store:e))}),this.store=new g(this.$$store),d(this),this}},{key:"snapshot",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return new y(this.store,this.$$store,t)}},{key:"unwatch",value:function(t){var e=(0,u.findIndex)(this.$$watchers,function(e){return e===t});return this.$$watchers=[].concat(r(this.$$watchers.slice(0,e)),r(this.$$watchers.slice(e+1,this.$$watchers.length))),this}},{key:"watch",value:function(t){return(0,u.isFunction)(t)&&(this.$$watchers=[].concat(r(this.$$watchers),[t])),this}}]),t}();e.SingulumActions=b,e.SingulumSnapshot=y,e.SingulumStore=g,e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},o=Object.defineProperty,i=Object.getOwnPropertyNames,u=Object.prototype.toString,s=e.bindFunction=function(t,e){return function(){for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];return t.apply(e,r)}},c=e.findIndex=function(t,e){for(var n=0,r=t.length;r>n;n++)if(e(t[n],n,t))return n;return-1},a=e.forEachObject=function(t,e){for(var n=Object.keys(t),r=0,o=n.length;o>r;r++){var i=n[r];e(t[i],i,t)}},f=e.getClone=function P(t,e){if(d(t))return t.map(function(t){return P(t,e)});if(p(t)){var n=function(){var n={};return a(t,function(t,r){n[r]=P(t,e)}),y(t,e)&&(n=new e(n)),{v:n}}();if("object"===("undefined"==typeof n?"undefined":r(n)))return n.v}return $(t)?new Date(t.valueOf()):t},l=e.getMutableObject=function(t){var e=d(t);if(!e&!p(t))return t;var n=e?[]:{};return e?t.forEach(function(e,r){E(t,r,n)}):a(t,function(e,r){E(t,r,n)}),n},h=e.hashCode=function x(t,e){var n=S(t,e);if(""===n)return 0;for(var x=0,r=void 0,o=0,i=n.length;i>o;o++)r=n.charCodeAt(o),x=(x<<5)-x+r,x|=0;return x},d=e.isArray=function(t){return"[object Array]"===u.call(t)},v=e.isClassInstance=function(t){return p(t)&&Object.getPrototypeOf(t).constructor!==Object.prototype.constructor},$=e.isDate=function(t){return"[object Date]"===u.call(t)},b=e.isEqual=function(t,e,n){return h(t,n)===h(e,n)},g=e.isFunction=function(t){return"[object Function]"===u.call(t)||"function"==typeof t},y=e.isInstanceOf=function(t,e){return t instanceof e},p=e.isObject=function(t){return"[object Object]"===u.call(t)&&!!t},O=e.isProduction=function(){return!0},m=e.isString=function(t){return"[object String]"===u.call(t)},j=e.isUndefined=function(t){return void 0===t},w=e.setHidden=function(t,e,n){o(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0})},S=function A(t,e){y(t,e)&&(t=t.store);var n="undefined"==typeof t?"undefined":r(t),o="";if("object"===n)for(var i in t)o+="{"+n+":"+i+A(t[i],e)+"}";else o+="function"===n?"{"+n+":"+t.toString()+"}":"{"+n+":"+t+"}";return o.replace(/\s/g,"")},E=function(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e)||{},i=t[e];(d(i)||p(i))&&(i=l(i)),o(n,e,{configurable:!0,enumerable:r.enumerable||!0,value:i,writable:!0})},I=e.setImmutable=function F(t,e,n){var r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],u=void 0;switch(!0){case d(n):u=[],n.forEach(function(t,e){F(u,e,t)});break;case p(n):u={},i(n).forEach(function(t){F(u,t,n[t])});break;case $(n):u=n.valueOf();break;case g(n):u=function(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];return n.apply(this,e)},a(n,function(t,e){n.hasOwnProperty(e)&&F(u,e,t)});break;default:u=n}return o(t,e,{get:function(){return u},set:function(){throw new SyntaxError("You are trying to set a value on an immutable object which is not allowed. Check the assignment of property "+e+".")},configurable:!1,enumerable:r.enumerable||!0}),t[e]},k=e.setReadonly=function(t,e,n){o(t,e,{get:function(){return n},set:function(){C("Cannot set a value for "+e+", as it is immutable.")}})},C=e.throwError=function(t){throw new Error(t)};e.default={bindFunction:s,findIndex:c,forEachObject:a,getClone:f,getMutableObject:l,hashCode:h,isArray:d,isClassInstance:v,isDate:$,isEqual:b,isFunction:g,isInstanceOf:y,isObject:p,isProduction:O,isString:m,isUndefined:j,setHidden:w,setImmutable:I,setReadonly:k,throwError:C}}])});